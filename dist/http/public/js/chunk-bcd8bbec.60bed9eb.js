(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bcd8bbec"],{"082c":function(t,n,e){},"21d5":function(t,n,e){},"29f4":function(t,n,e){"use strict";var o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("baidu-map",{staticClass:"bm-view",style:{paddingRight:t.paddingRight},attrs:{center:t.center,zoom:t.zoom,"scroll-wheel-zoom":!0,"continuous-zoom":!0}},[e("bm-map-type",{attrs:{"map-types":["BMAP_NORMAL_MAP","BMAP_HYBRID_MAP"],anchor:"BMAP_ANCHOR_TOP_LEFT"}}),e("bm-scale",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_LEFT"}}),e("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT",showAddressBar:!0,autoLocation:!0}}),e("bm-panorama"),t._l(t.points,function(n,o){return e("bm-marker",{key:o,attrs:{position:{lng:n.lng,lat:n.lat},animation:"BMAP_ANIMATION_DROP",title:n.id,icon:{url:t.config.url+"/img/person.png",size:{width:32,height:32}}},on:{click:function(e){t.handleInfoWindow(n)}}})}),e("bm-info-window",{attrs:{position:{lng:t.pointInfo.lng,lat:t.pointInfo.lat},show:t.show,title:"设备号："+t.pointInfo.id,offset:{width:3,height:-15}},on:{close:t.infoWindowClose,open:t.infoWindowOpen}},[e("span",{staticClass:"point-span"},[e("Row",[e("Col",{attrs:{span:"18"}},[t._v("\n          时间："+t._s(t.pointInfo.time)+"\n          ")]),e("Col",{attrs:{span:"6"}},[t._v("\n          定位："+t._s(t.pointInfo.qf)+"\n          ")])],1),e("Row",[e("Col",{attrs:{span:"12"}},[t._v("\n          经度："+t._s(t.pointInfo.lng)+"\n          ")]),e("Col",{attrs:{span:"12"}},[t._v("\n          纬度："+t._s(t.pointInfo.lat)+"\n          ")])],1),e("Row",[e("Col",{attrs:{span:"8"}},[t._v("\n          高度："+t._s(t.pointInfo.alt)+"\n          ")]),e("Col",{attrs:{span:"8"}},[t._v("\n          速度："+t._s(t.pointInfo.speed)+"\n          ")]),e("Col",{attrs:{span:"8"}},[t._v("\n          方向："+t._s(t.pointInfo.track_true)+"\n          ")])],1)],1)])],2)],1)},i=[],a=(e("ac6a"),e("7514"),e("89a9")),s=e.n(a),r=e("c516"),l=e("00b6"),c=e("4653"),d={props:{paddingRight:{type:String,default:"200px"}},data:function(){return{center:{lng:116.404,lat:39.915},zoom:15,points:[],show:!1,pointInfo:"",config:l}},computed:{},created:function(){var t=this;c["a"].service("position").find({query:{$limit:1,$sort:{time:-1}}}).then(function(n){setTimeout(function(){t.center={lng:n.data[0].lng,lat:n.data[0].lat}},500)}).catch(function(n){t.$Message.error({content:"获取位置错误："+n,duration:10,closable:!0})})},mounted:function(){var t=this;r["a"].$on("device-selected",function(n){var e=s.a.find(t.points,{id:n.id});e?(t.center={lng:e.lng,lat:e.lat},t.zoom=19,t.handleInfoWindow(e)):t.$Message.error({content:"此用户无数据",duration:3,closable:!0})}),setInterval(function(){c["a"].service("position").find({query:{$limit:10,$sort:{time:-1}}}).then(function(n){s.a.forEach(n.data,function(n){var e=s.a.find(t.points,{id:n.id});if(e)n.time>e.time&&(t.points=s.a.reject(t.points,{id:n.id}),t.points.push(n),t.show&&t.handleInfoWindow(n));else{var o=s.a.find(t.$store.state.list,{id:n.id});o&&t.points.push(n)}})}).catch(function(n){t.$Message.error({content:"刷新位置错误："+n,duration:10,closable:!0})})},1e3)},methods:{handleInfoWindow:function(t){this.show=!0,this.pointInfo=s.a.find(this.points,{id:t.id})},infoWindowClose:function(){this.show=!1},infoWindowOpen:function(){this.show=!0}}},p=d,f=(e("744d"),e("2877")),u=Object(f["a"])(p,o,i,!1,null,"61c63496",null);u.options.__file="baiduRealTime.vue";var h=u.exports,m=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("baidu-map",{staticClass:"bm-view",style:{paddingRight:t.paddingRight},attrs:{center:t.center,zoom:t.zoom,"scroll-wheel-zoom":!0,"continuous-zoom":!0}},[e("bm-map-type",{attrs:{"map-types":["BMAP_NORMAL_MAP","BMAP_HYBRID_MAP"],anchor:"BMAP_ANCHOR_TOP_LEFT"}}),e("bm-scale",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_LEFT"}}),e("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT",showAddressBar:!0,autoLocation:!0}}),e("bm-panorama"),t.clear?e("bm-polyline",{attrs:{path:t.polylinePath,"stroke-color":"red","stroke-opacity":.5,"stroke-weight":3}}):t._e(),t._l(t.polylinePath,function(n,o){return e("bm-marker",{key:o,attrs:{position:{lng:n.lng,lat:n.lat},title:n.id,icon:{url:t.config.url+"/img/point.png",size:{width:32,height:32}}},on:{click:function(e){t.handleInfoWindow(n)}}})}),t.clear?e("bm-marker",{attrs:{position:t.polyStartEnd.end,rotation:-35,zIndex:-1,icon:{url:t.config.url+"/img/end.png",size:{width:48,height:48},opts:{anchor:{width:35,height:40}}}}},[t.clear?e("bm-marker",{attrs:{position:t.polyStartEnd.start,rotation:35,zIndex:-1,icon:{url:t.config.url+"/img/start.png",size:{width:48,height:48},opts:{anchor:{width:15,height:40}}}}}):t._e()],1):t._e(),e("bm-info-window",{attrs:{position:{lng:t.pointInfo.lng,lat:t.pointInfo.lat},show:t.show,title:"设备号："+t.pointInfo.id,offset:{width:3,height:-3}},on:{close:t.infoWindowClose,open:t.infoWindowOpen}},[e("span",{staticClass:"point-span"},[e("Row",[e("Col",{attrs:{span:"18"}},[t._v("\n          时间："+t._s(t.pointInfo.time)+"\n          ")]),e("Col",{attrs:{span:"6"}},[t._v("\n          定位："+t._s(t.pointInfo.qf)+"\n          ")])],1),e("Row",[e("Col",{attrs:{span:"12"}},[t._v("\n          经度："+t._s(t.pointInfo.lng)+"\n          ")]),e("Col",{attrs:{span:"12"}},[t._v("\n          纬度："+t._s(t.pointInfo.lat)+"\n          ")])],1),e("Row",[e("Col",{attrs:{span:"8"}},[t._v("\n          高度："+t._s(t.pointInfo.alt)+"\n          ")]),e("Col",{attrs:{span:"8"}},[t._v("\n          速度："+t._s(t.pointInfo.speed)+"\n          ")]),e("Col",{attrs:{span:"8"}},[t._v("\n          方向："+t._s(t.pointInfo.track_true)+"\n          ")])],1)],1)])],2)],1)},_=[],g={props:{paddingRight:{type:String,default:"200px"}},data:function(){return{center:{lng:116.404,lat:39.915},zoom:15,show:!1,pointInfo:"",polyStartEnd:{start:"",end:""},clear:!0,config:l}},mounted:function(){var t=this;r["a"].$on("history-clicked",function(n){t.center={lng:n.lng,lat:n.lat},t.handleInfoWindow(n)}),r["a"].$on("history-clear",function(){t.clear=!1,t.show=!1})},methods:{handleInfoWindow:function(t){this.show=!0,this.pointInfo=t},infoWindowClose:function(){this.show=!1},infoWindowOpen:function(){this.show=!0}},computed:{polylinePath:function(){var t=this.$store.state.historyList;if(t[0]){this.clear=!0,this.polyStartEnd.end=t[0],this.center={lng:t[0].lng,lat:t[0].lat};var n=t.length;this.polyStartEnd.start=t[n-1]}return t}}},v=g,w=(e("e939"),Object(f["a"])(v,m,_,!1,null,"97078afa",null));w.options.__file="baiduHistory.vue";var b=w.exports;e.d(n,"a",function(){return b}),e.d(n,"b",function(){return h})},"46d6":function(t,n,e){},"64b3":function(t,n,e){},"744d":function(t,n,e){"use strict";var o=e("21d5"),i=e.n(o);i.a},"80de":function(t,n,e){"use strict";var o=e("a03d"),i=e.n(o);i.a},"9d67":function(t,n,e){"use strict";t.exports=(t=>{const n=(t||new Date).getTimezoneOffset(),e=Math.abs(n),o=Math.floor(e/60),i=e%60,a=i>0?":"+("0"+i).slice(-2):"";return(n<0?"+":"-")+o+a})},a03d:function(t,n,e){},aaf1:function(t,n,e){},b920:function(t,n,e){"use strict";const o=e("9d67");t.exports=(t=>{t=Object.assign({date:new Date,local:!0,showTimeZone:!1,showMilliseconds:!1},t);let n=t.date;t.local&&(n=new Date(n.getTime()-6e4*n.getTimezoneOffset()));let e="";return t.showTimeZone&&(e=" UTC"+(t.local?o(n):"")),t.showMilliseconds&&n.getUTCMilliseconds()>0&&(e=` ${n.getUTCMilliseconds()}ms${e}`),n.toISOString().replace(/T/," ").replace(/\..+/,e)})},c70b:function(t,n,e){"use strict";var o=e("46d6"),i=e.n(o);i.a},c77c:function(t,n,e){"use strict";var o=e("64b3"),i=e.n(o);i.a},e4bb:function(t,n,e){"use strict";e.r(n);var o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"layout"},[e("baidu-history",{attrs:{paddingRight:"530px"}}),e("Layout",[e("Sider",{staticClass:"layout-sider",attrs:{width:330}},[e("Card",{attrs:{padding:0,bordered:!1}},[e("p",{attrs:{slot:"title"},slot:"title"},[t._v("轨迹查询")]),e("record")],1)],1)],1)],1)},i=[],a=(e("cadf"),e("551c"),e("097d"),e("29f4")),s=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("Card",{attrs:{padding:2}},[e("operate")],1),e("Card",{staticClass:"operate",attrs:{padding:2}},[e("point")],1)],1)},r=[],l=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("Table",{attrs:{columns:t.columns,data:t.data,size:"small","highlight-row":""},on:{"on-row-dblclick":t.deviceClick}})},c=[],d=(e("ac6a"),function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("Row",{staticClass:"expand-row"},[e("Col",{attrs:{span:"12"}},[e("p",{staticClass:"expand-key"},[t._v("经度 ")]),e("span",{staticClass:"expand-value"},[t._v(t._s(t.row.lng))])]),e("Col",{attrs:{span:"12"}},[e("p",{staticClass:"expand-key"},[t._v("纬度 ")]),e("span",{staticClass:"expand-value"},[t._v(t._s(t.row.lat))])])],1),e("Row",[e("Col",{attrs:{span:"8"}},[e("p",{staticClass:"expand-key"},[t._v("高度 ")]),e("span",{staticClass:"expand-value"},[t._v(t._s(t.row.alt))])]),e("Col",{attrs:{span:"8"}},[e("p",{staticClass:"expand-key"},[t._v("速度 ")]),e("span",{staticClass:"expand-value"},[t._v(t._s(t.row.speed))])]),e("Col",{attrs:{span:"8"}},[e("p",{staticClass:"expand-key"},[t._v("方向 ")]),e("span",{staticClass:"expand-value"},[t._v(t._s(t.row.track_true))])])],1)],1)}),p=[],f={props:{row:Object}},u=f,h=(e("e58d"),e("2877")),m=Object(h["a"])(u,d,p,!1,null,"2adbe580",null);m.options.__file="expand.vue";var _=m.exports,g=e("c516"),v=e("89a9"),w=e.n(v),b={components:{expandRow:_},data:function(){return{columns:[{type:"expand",width:20,render:function(t,n){return t(_,{props:{row:n.row}})}},{title:"序号",key:"no",width:60,align:"center"},{title:"时间",key:"time",align:"center"},{title:"定位",key:"qf",width:60,align:"center"}]}},computed:{data:function(){var t=this.$store.state.historyList;return t[0]&&w.a.forEach(t,function(n,e){t[e].no=e+1,t[e].time=n.time}),t}},methods:{deviceClick:function(t){g["a"].$emit("history-clicked",t)}}},y=b,C=(e("f3a1"),Object(h["a"])(y,l,c,!1,null,null,null));C.options.__file="point.vue";var I=C.exports,O=I,k=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("Form",{attrs:{model:t.formItem,"label-width":60,"label-position":"left"}},[e("FormItem",{staticStyle:{margin:"2px 2px"},attrs:{label:"开始时间"}},[e("DatePicker",{attrs:{size:"small",type:"datetime",placeholder:"选择查询开始时间"},model:{value:t.formItem.datetime.start,callback:function(n){t.$set(t.formItem.datetime,"start",n)},expression:"formItem.datetime.start"}})],1),e("FormItem",{staticStyle:{margin:"2px 2px"},attrs:{label:"结束时间"}},[e("DatePicker",{attrs:{size:"small",type:"datetime",placeholder:"选择查询结束时间"},model:{value:t.formItem.datetime.end,callback:function(n){t.$set(t.formItem.datetime,"end",n)},expression:"formItem.datetime.end"}})],1),e("div",{staticStyle:{margin:"5px 0 5px 0","text-align":"center"}},[e("Button",{attrs:{type:"primary",size:"small",ghost:""},on:{click:t.select}},[t._v("查询")]),e("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"error",size:"small",ghost:""},on:{click:t.clear}},[t._v("清除")])],1)],1)],1)},x=[],M=(e("7514"),e("be94")),$=e("4653"),R=e("2f62"),T=e("b920"),A=e.n(T),P={data:function(){return{formItem:{datetime:{start:"",end:""},slider:1},trackData:[]}},mounted:function(){this.$Message.config({top:64,duration:3})},methods:Object(M["a"])({},Object(R["b"])(["getHistoryList","clearHistoryList"]),{select:function(){var t=this.$store.state.checked;if(t[0])if(t.length>1)this.$Message.error({content:"暂不支持多个设备查询",closable:!0});else{this.clear();for(var n=t[0].id,e=6e5,o=new Date(this.formItem.datetime.start),i=new Date(this.formItem.datetime.end),a=o.getTime(),s=i.getTime(),r=Math.ceil((s-a)/e),l=0;l<r;l++){var c=a+l*e,d=a+(l+1)*e;l==r-1&&(d=s),c=A()({date:new Date(c)}),d=A()({date:new Date(d)}),this.getPosition(n,c,d)}this.$Message.loading({content:"查询轨迹中...",closable:!0})}else this.$Message.error({content:"请选择查询设备",duration:3,closable:!0})},clear:function(){this.clearHistoryList(),g["a"].$emit("history-clear")},getPosition:function(t,n,e){var o=this;$["a"].service("position").find({query:{id:t,$sort:{time:-1},time:{$lte:e,$gte:n}}}).then(function(t){o.getHistoryList(t.data)}).catch(function(t){o.loading=!1,o.$Message.error({content:"查询轨迹失败"+t,closable:!0})})}})},z=P,B=(e("80de"),Object(h["a"])(z,k,x,!1,null,"753755cf",null));B.options.__file="operate.vue";var E=B.exports,H=E,L={components:{Point:O,Operate:H}},W=L,S=(e("c77c"),Object(h["a"])(W,s,r,!1,null,"df34bb28",null));S.options.__file="record.vue";var D=S.exports,j=D,N={components:{BaiduHistory:a["a"],Record:j}},F=N,q=(e("c70b"),Object(h["a"])(F,o,i,!1,null,"41ee3f74",null));q.options.__file="History.vue";n["default"]=q.exports},e58d:function(t,n,e){"use strict";var o=e("082c"),i=e.n(o);i.a},e939:function(t,n,e){"use strict";var o=e("aaf1"),i=e.n(o);i.a},f3a1:function(t,n,e){"use strict";var o=e("fc04"),i=e.n(o);i.a},fc04:function(t,n,e){}}]);
//# sourceMappingURL=chunk-bcd8bbec.60bed9eb.js.map